(()=>{"use strict";function e(e,t,n,c,r,a,o){try{var s=e[a](o),i=s.value}catch(e){return void n(e)}s.done?t(i):Promise.resolve(i).then(c,r)}function t(t){return function(){var n=this,c=arguments;return new Promise((function(r,a){var o=t.apply(n,c);function s(t){e(o,r,a,s,i,"next",t)}function i(t){e(o,r,a,s,i,"throw",t)}s(void 0)}))}}function n(e,t,n){return c.apply(this,arguments)}function c(){return(c=t(regeneratorRuntime.mark((function e(t,n,c){var r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=c&&c.visualFeatures.length>0?c.visualFeatures.join(","):"",a=c&&c.details.length>0?c.details.join(","):"",e.abrupt("return",fetch("".concat(t,"visualFeatures=").concat(r,"&details=").concat(a),{method:"POST",headers:{"Ocp-Apim-Subscription-Key":"7470877468174b49bc99d76b51b32b4d","Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Headers":"X-MS-Trans-Info"},body:JSON.stringify({url:n})}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function r(e,t,n,c,r,a,o){try{var s=e[a](o),i=s.value}catch(e){return void n(e)}s.done?t(i):Promise.resolve(i).then(c,r)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(c,a){var o=e.apply(t,n);function s(e){r(o,c,a,s,i,"next",e)}function i(e){r(o,c,a,s,i,"throw",e)}s(void 0)}))}}var o=document.getElementById("canvas"),s=o.getContext("2d"),i=new Image,u="",l="https://southeastasia.api.cognitive.microsoft.com/vision/v3.1/analyze?";o.width=1e3,o.height=800;var d,h,v,p;function f(){var e={visualFeatures:[],details:[]};return document.querySelectorAll("#visual-features > .checkbox-group > input").forEach((function(t){t.checked&&e.visualFeatures.push(t.dataset.x)})),document.querySelectorAll("#details > .checkbox-group > input").forEach((function(t){t.checked&&e.details.push(t.dataset.x)})),e}function g(e,t){var n={x:0,y:0,w:0,h:0},c=t.width,r=t.height,a=e.naturalWidth,o=e.naturalHeight;return a>c||o>r?a/o>c/r?(n.w=c,n.h=c/a*o):(n.h=r,n.w=r/o*a):(n.w=a,n.h=o),n.x=(c-n.w)/2,n.y=(r-n.h)/2,n}function y(e,t,n){var c=n.w/e.naturalWidth,r=n.h/e.naturalHeight;return{x:t.x*c+n.x,y:t.y*r+n.y,w:t.w*c,h:t.h*r}}function m(e,t,n,c){console.log("alo"),t.onload=function(){var n=g(t,o);e.strokeStyle="red",e.lineWidth=2,c.faces&&c.faces.map((function(e){var c=e.faceRectangle,r={x:c.left,y:c.top,w:c.width,h:c.height};return y(t,r,n)})).forEach((function(t){return e.strokeRect(t.x,t.y,t.w,t.h)})),c.objects&&c.objects.map((function(e){var c=e.rectangle;return y(t,c,n)})).forEach((function(t){return e.strokeRect(t.x,t.y,t.w,t.h)}))},t.src=n}d=document.querySelector("#visual-features"),h=document.querySelector("#details"),v=["Adult","Brands","Categories","Color","Description","Faces","ImageType","Objects","Tags"].map((function(e,t){return'\n            <div class="checkbox-group">\n                <input\n                    type="checkbox"\n                    class="checkbox-input"\n                    id="'.concat("visualfeatures-"+t,'"\n                    data-x="').concat(e,'"\n                    ').concat([3,4,5].includes(t)?"checked":null,'\n                    />\n                <label for="').concat("visualfeatures-"+t,'" class="checkbox-label">\n                    <span class="checkbox-button">\n                        <svg class="checkbox-icon">\n                            <use href="/assets/sprites.svg#icon-checkmark"></use>\n                        </svg>\n                    </span>\n                    ').concat(e,"\n                </label>\n            </div>\n        ")})).join(""),p=["Celebrities","Landmarks"].map((function(e,t){return'\n            <div class="checkbox-group">\n                <input\n                    type="checkbox"\n                    class="checkbox-input"\n                    id="'.concat("details-"+t,'"\n                    data-x="').concat(e,'"\n                    />\n                <label for="').concat("details-"+t,'" class="checkbox-label">\n                    <span class="checkbox-button">\n                        <svg class="checkbox-icon">\n                            <use href="/assets/sprites.svg#icon-checkmark"></use>\n                        </svg>\n                    </span>\n                    ').concat(e,"\n                </label>\n            </div>\n        ")})).join(""),d.insertAdjacentHTML("beforeend",v),h.insertAdjacentHTML("beforeend",p),document.querySelector("#url").addEventListener("change",(function(e){i.onload=function(){s.clearRect(0,0,o.width,o.height);var e=g(i,o);s.drawImage(i,0,0,i.naturalWidth,i.naturalHeight,e.x,e.y,e.w,e.h)},i.onerror=function(){i.src="/assets/default-image.png"},i.src=e.target.value,u=e.target.value})),document.querySelector("#callApiBtn").addEventListener("click",a(regeneratorRuntime.mark((function e(){var t,c,r,a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("fetching data..."),document.querySelector("#callApiBtn").style["pointer-events"]="none",document.querySelector("#callApiBtn > svg > use").setAttribute("href","/assets/sprites.svg#icon-spinner"),document.querySelector("#callApiBtn > svg").classList.toggle("active"),t=f(),c=t&&t.visualFeatures.length>0?t.visualFeatures.join(","):"",r=t&&t.details.length>0?t.details.join(","):"",document.querySelector(".request__url > p:last-child").textContent="".concat(l,"visualFeatures=").concat(c,"&details=").concat(r),document.querySelector(".request__body > textarea").textContent=JSON.stringify({url:u},void 0,4),e.next=11,n(l,u,t);case 11:return a=e.sent,e.next=14,a.json();case 14:o=e.sent,document.querySelector(".response__body").textContent=JSON.stringify(o,void 0,4),console.log("success..."),console.log(o),m(s,i,u,o),document.querySelector("#callApiBtn").style["pointer-events"]="auto",document.querySelector("#callApiBtn > svg > use").setAttribute("href","/assets/sprites.svg#icon-checkmark"),document.querySelector("#callApiBtn > svg").classList.toggle("active");case 22:case"end":return e.stop()}}),e)}))))})();